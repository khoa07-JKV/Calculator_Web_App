<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Graphing Calculator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            padding: 20px;
        }

        .back-button {
            margin: 20px;
            padding: 10px 20px;
            background: white;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            cursor: pointer;
            text-decoration: none;
            color: #43e97b;
            font-weight: 600;
            transition: transform 0.2s;
            display: inline-block;
            align-self: flex-start;
        }

        .back-button:hover {
            transform: scale(1.05);
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            width: 100%;
        }

        .calculator-panel {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 50px rgba(0, 0, 0, 0.3);
            margin-bottom: 20px;
        }

        h1 {
            color: #333;
            margin-bottom: 20px;
            text-align: center;
        }

        .input-section {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: 600;
        }

        input[type="text"] {
            width: 100%;
            padding: 12px;
            font-size: 1.1rem;
            border: 2px solid #ddd;
            border-radius: 10px;
            transition: border-color 0.3s;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: #43e97b;
        }

        .range-inputs {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .range-group input {
            width: 100%;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        button {
            flex: 1;
            padding: 12px 24px;
            font-size: 1rem;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .plot-btn {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: white;
        }

        .plot-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(67, 233, 123, 0.4);
        }

        .clear-btn {
            background: #f56565;
            color: white;
        }

        .clear-btn:hover {
            background: #e53e3e;
        }

        canvas {
            width: 100%;
            height: 500px;
            border-radius: 10px;
            background: white;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
        }

        .examples {
            margin-top: 15px;
            padding: 15px;
            background: #f7fafc;
            border-radius: 10px;
        }

        .examples h3 {
            color: #555;
            font-size: 0.9rem;
            margin-bottom: 8px;
        }

        .examples p {
            color: #666;
            font-size: 0.85rem;
            margin: 4px 0;
        }

        .error {
            color: #e53e3e;
            padding: 10px;
            background: #fff5f5;
            border-radius: 8px;
            margin-top: 10px;
            display: none;
        }
    </style>
</head>
<body>
    <a href="index.html" class="back-button">← Back to Home</a>
    
    <div class="container">
        <div class="calculator-panel">
            <h1>Graphing Calculator</h1>
            
            <div class="input-section">
                <label for="equation">Enter Function (use 'x' as variable):</label>
                <input type="text" id="equation" placeholder="e.g., x^2, sin(x), x^3 - 2*x + 1" value="x^2">
            </div>

            <div class="range-inputs">
                <div class="range-group">
                    <label for="xmin">X Min:</label>
                    <input type="text" id="xmin" value="-10">
                </div>
                <div class="range-group">
                    <label for="xmax">X Max:</label>
                    <input type="text" id="xmax" value="10">
                </div>
                <div class="range-group">
                    <label for="ymin">Y Min:</label>
                    <input type="text" id="ymin" value="-10">
                </div>
                <div class="range-group">
                    <label for="ymax">Y Max:</label>
                    <input type="text" id="ymax" value="10">
                </div>
            </div>

            <div class="button-group">
                <button class="plot-btn" onclick="plotGraph()">Plot Graph</button>
                <button class="clear-btn" onclick="clearGraph()">Clear</button>
            </div>

            <div class="error" id="error"></div>

            <div class="examples">
                <h3>Example Functions:</h3>
                <p>• Parabola: x^2</p>
                <p>• Sine wave: sin(x)</p>
                <p>• Cubic: x^3 - 2*x + 1</p>
                <p>• Circle: sqrt(25 - x^2) (plot with x: -5 to 5, y: -5 to 5)</p>
                <p>• Exponential: 2^x or exp(x)</p>
            </div>
        </div>

        <canvas id="graph"></canvas>
    </div>

    <script>
        const canvas = document.getElementById('graph');
        const ctx = canvas.getContext('2d');
        const error = document.getElementById('error');

        function resizeCanvas() {
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width * window.devicePixelRatio;
            canvas.height = rect.height * window.devicePixelRatio;
            ctx.scale(window.devicePixelRatio, window.devicePixelRatio);
            plotGraph();
        }

        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();

        function plotGraph() {
            error.style.display = 'none';
            
            const equation = document.getElementById('equation').value;
            const xMin = parseFloat(document.getElementById('xmin').value);
            const xMax = parseFloat(document.getElementById('xmax').value);
            const yMin = parseFloat(document.getElementById('ymin').value);
            const yMax = parseFloat(document.getElementById('ymax').value);

            if (isNaN(xMin) || isNaN(xMax) || isNaN(yMin) || isNaN(yMax)) {
                showError('Please enter valid numbers for the range');
                return;
            }

            const rect = canvas.getBoundingClientRect();
            const width = rect.width;
            const height = rect.height;

            ctx.clearRect(0, 0, width, height);

            // Draw grid
            ctx.strokeStyle = '#e2e8f0';
            ctx.lineWidth = 1;

            const xStep = (xMax - xMin) / 10;
            const yStep = (yMax - yMin) / 10;

            for (let i = 0; i <= 10; i++) {
                const x = (i / 10) * width;
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, height);
                ctx.stroke();

                const y = (i / 10) * height;
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(width, y);
                ctx.stroke();
            }

            // Draw axes
            ctx.strokeStyle = '#2d3748';
            ctx.lineWidth = 2;

            const xAxisY = height * (yMax / (yMax - yMin));
            if (xAxisY >= 0 && xAxisY <= height) {
                ctx.beginPath();
                ctx.moveTo(0, xAxisY);
                ctx.lineTo(width, xAxisY);
                ctx.stroke();
            }

            const yAxisX = width * (-xMin / (xMax - xMin));
            if (yAxisX >= 0 && yAxisX <= width) {
                ctx.beginPath();
                ctx.moveTo(yAxisX, 0);
                ctx.lineTo(yAxisX, height);
                ctx.stroke();
            }

            // Plot function
            ctx.strokeStyle = '#3b82f6';
            ctx.lineWidth = 3;
            ctx.beginPath();

            let firstPoint = true;
            const step = (xMax - xMin) / width;

            try {
                for (let px = 0; px <= width; px++) {
                    const x = xMin + (px / width) * (xMax - xMin);
                    const y = evaluateFunction(equation, x);

                    if (!isNaN(y) && isFinite(y)) {
                        const py = height - ((y - yMin) / (yMax - yMin)) * height;

                        if (py >= -height && py <= height * 2) {
                            if (firstPoint) {
                                ctx.moveTo(px, py);
                                firstPoint = false;
                            } else {
                                ctx.lineTo(px, py);
                            }
                        } else {
                            firstPoint = true;
                        }
                    } else {
                        firstPoint = true;
                    }
                }
                ctx.stroke();
            } catch (e) {
                showError('Invalid function. Please check your equation.');
            }

            // Draw labels
            ctx.fillStyle = '#4a5568';
            ctx.font = '12px sans-serif';
            ctx.fillText(`(${xMin.toFixed(1)}, ${yMin.toFixed(1)})`, 5, height - 5);
            ctx.fillText(`(${xMax.toFixed(1)}, ${yMax.toFixed(1)})`, width - 80, 15);
        }

        function evaluateFunction(expr, x) {
            expr = expr.replace(/\^/g, '**');
            expr = expr.replace(/sin/g, 'Math.sin');
            expr = expr.replace(/cos/g, 'Math.cos');
            expr = expr.replace(/tan/g, 'Math.tan');
            expr = expr.replace(/sqrt/g, 'Math.sqrt');
            expr = expr.replace(/exp/g, 'Math.exp');
            expr = expr.replace(/ln/g, 'Math.log');
            expr = expr.replace(/log/g, 'Math.log10');
            expr = expr.replace(/abs/g, 'Math.abs');
            
            return Function('x', '"use strict"; return (' + expr + ')')(x);
        }

        function clearGraph() {
            const rect = canvas.getBoundingClientRect();
            ctx.clearRect(0, 0, rect.width, rect.height);
            document.getElementById('equation').value = '';
            error.style.display = 'none';
        }

        function showError(message) {
            error.textContent = message;
            error.style.display = 'block';
        }

        // Initial plot
        plotGraph();
    </script>
</body>
</html>